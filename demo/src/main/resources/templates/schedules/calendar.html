<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ìï©Ï£º ÏùºÏ†ï Ï∫òÎ¶∞Îçî</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üé∏ Ìï©Ï£º ÏùºÏ†ï Ï∫òÎ¶∞Îçî</h1>
            <a th:href="@{/schedules/new}" class="btn btn-primary">ÏùºÏ†ï Ï∂îÍ∞Ä</a>
        </header>

        <!-- ÏÑ±Í≥µ/Ïò§Î•ò Î©îÏãúÏßÄ -->
        <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
        <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

        <!-- Ïõî ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
        <div class="calendar-navigation">
            <a th:href="@{/schedules(year=${year}, month=${month == 1 ? 12 : month - 1}, year=${month == 1 ? year - 1 : year})}" 
               class="btn btn-nav">‚óÄ Ïù¥Ï†Ñ</a>
            <h2 class="current-month" th:text="${year} + 'ÎÖÑ ' + ${month} + 'Ïõî'"></h2>
            <a th:href="@{/schedules(year=${year}, month=${month == 12 ? 1 : month + 1}, year=${month == 12 ? year + 1 : year})}" 
               class="btn btn-nav">Îã§Ïùå ‚ñ∂</a>
        </div>

        <!-- Îã¨Î†• -->
        <div class="calendar">
            <div class="calendar-header">
                <div class="day-header">Ïùº</div>
                <div class="day-header">Ïõî</div>
                <div class="day-header">Ìôî</div>
                <div class="day-header">Ïàò</div>
                <div class="day-header">Î™©</div>
                <div class="day-header">Í∏à</div>
                <div class="day-header">ÌÜ†</div>
            </div>
            <div class="calendar-body">
                <!-- ÏãúÏûë ÏöîÏùº Ï†Ñ Îπà Ïπ∏ -->
                <div th:each="i : ${#numbers.sequence(0, startDayOfWeek - 1)}" class="calendar-day empty"></div>
                
                <!-- Í∞Å ÎÇ†Ïßú -->
                <div th:each="day : ${#numbers.sequence(1, daysInMonth)}" 
                     class="calendar-day"
                     th:classappend="${#temporals.day(#temporals.createToday()) == day && 
                                     #temporals.month(#temporals.createToday()) == month && 
                                     #temporals.year(#temporals.createToday()) == year} ? 'today' : ''">
                    
                    <div class="day-number" th:text="${day}"></div>
                    
                    <!-- Ìï¥Îãπ ÎÇ†ÏßúÏùò ÏùºÏ†ï ÌëúÏãú -->
                    <div class="schedules-container">
                        <div th:each="schedule : ${schedules}" 
                             th:if="${#temporals.day(schedule.scheduleDate) == day}"
                             class="schedule-item"
                             th:attr="data-id=${schedule.id}, data-team=${schedule.teamName}, 
                                     data-start=${schedule.startTime}, data-end=${schedule.endTime}">
                            <span class="schedule-time" 
                                  th:text="${#temporals.format(schedule.startTime, 'HH:mm')}"></span>
                            <span class="schedule-team" th:text="${schedule.teamName}"></span>
                            <div class="schedule-tooltip">
                                <strong th:text="${schedule.teamName}"></strong><br>
                                <span th:text="${#temporals.format(schedule.startTime, 'HH:mm')} + ' - ' + 
                                              ${#temporals.format(schedule.endTime, 'HH:mm')}"></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÎÇ†Ïßú ÌÅ¥Î¶≠ Ïãú ÏÉÅÏÑ∏ Î≥¥Í∏∞ -->
                    <a th:href="@{/schedules/daily/{date}(date=${year + '-' + 
                               (#strings.toString(month).length() == 1 ? '0' + month : month) + '-' + 
                               (#strings.toString(day).length() == 1 ? '0' + day : day)})}" 
                       class="day-detail-link">ÏÉÅÏÑ∏ Î≥¥Í∏∞</a>
                </div>
            </div>
        </div>
    </div>

    <script th:src="@{/js/calendar.js}"></script>
</body>
</html>
